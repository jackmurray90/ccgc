{% extends "base.html" %}

{% block head %}
  <style>
    p {
    }
    form > div {
      margin: 1em 0;
    }
    .messages .error {
      color: #f00;
    }
    .files form {
      display: inline-block;
    }
    .files button {
      background-color: transparent;
      color: #00f;
      border-style: none;
      padding: 0;
      margin: 0;
      cursor: pointer;
    }
  </style>
{% endblock %}

{% block content %}

  <h2>Upload a CSV file</h2>

  {% if messages %}
    <div class="messages">
        {% for message in messages %}
        <p{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</p>
        {% endfor %}
    </div>
  {% endif %}

  <form action="{% url "upload" %}" method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {{ form }}
    <div><input type="submit" value="Upload CSV file"></div>
  </form>

  <hr/>

  <h2>Uploaded files</h2>
  {% if user.csv_files.count == 0 %}
    <p>
      You have not uploaded any CSV files.
    </p>
  {% else %}
    <ul class="files">
      {% for csv_file in user.csv_files.all %}
        <li>
          {{ csv_file.filename }}
          <form action="{% url "delete" csv_file.id %}" method="post">
            {% csrf_token %}
            <button type="submit">(delete)</button>
          </form>
        </li>
      {% endfor %}
    </ul>
    <hr/>
    <p>Click <a href="{% url "calculate" %}">here</a> to calculate your capital gains.</p>
  {% endif %}

{% endblock %}
